"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var app = getApp();
Page({
    data: {
        id: "",
        server: "",
        serverIndex: null,
        serverList: ['官服', 'B服', '其他'],
        clueList: {
            "need": [{ name: "1", showFlag: false }, { name: "2", showFlag: false }, { name: "3", showFlag: false }, { name: "4", showFlag: false }, { name: "5", showFlag: false }, { name: "6", showFlag: false }, { name: "7", showFlag: false }],
            "have": [{ name: "1", showFlag: false }, { name: "2", showFlag: false }, { name: "3", showFlag: false }, { name: "4", showFlag: false }, { name: "5", showFlag: false }, { name: "6", showFlag: false }, { name: "7", showFlag: false }]
        },
        remark: "",
        loading: false,
        modalShow: false
    },
    onShareAppMessage() {
        console.log("onShareAppMessage");
        var value = wx.getStorageSync('changeClue');
        if (!value) {
            value = "快来找到你需要的线索~";
        }
        return {
            title: '明日方舟助手-线索交换',
            desc: value,
            imageUrl: '../../../images/ark66.jpg',
            success: function () {
                console.log("success");
                wx.navigateBack({
                    delta: 1
                });
            }
        };
    },
    PickerChange(e) {
        console.log(e);
        let tmp = this.data.serverList[e.detail.value];
        this.setData({
            serverIndex: e.detail.value,
            server: tmp
        });
    },
    InputChange: function (e) {
        console.log(e.target.dataset.type);
        console.log(e.detail.value);
        let type = e.target.dataset.type;
        if (type === 'remark') {
            this.setData({
                remark: e.detail.value
            });
        }
        else if (type === 'id') {
            this.setData({
                id: e.detail.value
            });
        }
    },
    hideModal: function () {
        wx.navigateBack({
            delta: 1
        });
    },
    clickClue(e) {
        console.log(e);
        let type = e.target.dataset.type;
        let clue = e.target.dataset.title;
        let clueTmp = this.data.clueList[type][clue];
        clueTmp.showFlag = !clueTmp.showFlag;
        this.setData({
            clueList: this.data.clueList
        });
    },
    saveChange() {
        if (!this.data.id) {
            wx.showToast({
                title: "请输入游戏id",
                icon: "none",
                duration: 2000
            });
            return;
        }
        if (!this.data.server) {
            wx.showToast({
                title: "请选择游戏区服",
                icon: "none",
                duration: 2000
            });
            return;
        }
        let needFlag = false;
        let needStr = "";
        this.data.clueList['need'].forEach((clue) => {
            if (clue.showFlag) {
                needFlag = true;
                needStr += clue.name + " ";
            }
        });
        let haveFlag = false;
        let haveStr = "";
        this.data.clueList['have'].forEach((clue) => {
            if (clue.showFlag) {
                haveFlag = true;
                haveStr += clue.name + " ";
            }
        });
        if (!needFlag) {
            wx.showToast({
                title: "请选择至少一个需要的线索",
                icon: "none",
                duration: 2000
            });
            return;
        }
        if (!haveFlag) {
            wx.showToast({
                title: "请选择至少一个用来交换的线索",
                icon: "none",
                duration: 2000
            });
            return;
        }
        let req = { id: this.data.id, server: this.data.server, remark: this.data.remark, clueList: this.data.clueList };
        let that = this;
        let changeClueStr = this.data.id + " " + this.data.server + " " + haveStr + " 换 " + needStr;
        that.setData({
            loading: true
        });
        app.func.post('/postChange', req, function (response) {
            console.log(response);
            if (response.status === 200) {
                wx.setStorage({
                    key: "changeClue",
                    data: changeClueStr
                });
                that.setData({
                    loading: false, modalShow: true
                });
            }
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibmV3LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBSSxHQUFHLEdBQUcsTUFBTSxFQUFFLENBQUE7QUFHbEIsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osRUFBRSxFQUFFLEVBQUU7UUFDTixNQUFNLEVBQUUsRUFBRTtRQUNWLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLFVBQVUsRUFBRSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQzlCLFFBQVEsRUFBRTtZQUNSLE1BQU0sRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFDeE8sTUFBTSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUs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QUUsYUFBYTtpQkFDcEIsQ0FBQyxDQUFBO2dCQUVGLElBQUksQ0FBQyxPQUFRLENBQUM7b0JBQ1osT0FBTyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsSUFBSTtpQkFDaEMsQ0FBQyxDQUFDO2FBRUo7UUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNKLENBQUM7Q0FFRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9jaGFuZ2UvbmV3L25ldy5qc1xyXG52YXIgYXBwID0gZ2V0QXBwKClcclxuLy9AdHMtaWdub3JlXHJcbmltcG9ydCBBcmtSZXNwID0gcmVxdWlyZSgnLi4vLi4vbW9kZWwvQXJrUmVzcC5qcycpO1xyXG5QYWdlKHtcclxuICBkYXRhOiB7XHJcbiAgICBpZDogXCJcIixcclxuICAgIHNlcnZlcjogXCJcIixcclxuICAgIHNlcnZlckluZGV4OiBudWxsLFxyXG4gICAgc2VydmVyTGlzdDogWyflrpjmnI0nLCAnQuacjScsICflhbbku5YnXSxcclxuICAgIGNsdWVMaXN0OiB7XHJcbiAgICAgIFwibmVlZFwiOiBbeyBuYW1lOiBcIjFcIiwgc2hvd0ZsYWc6IGZhbHNlIH0sIHsgbmFtZTogXCIyXCIsIHNob3dGbGFnOiBmYWxzZSB9LCB7IG5hbWU6IFwiM1wiLCBzaG93RmxhZzogZmFsc2UgfSwgeyBuYW1lOiBcIjRcIiwgc2hvd0ZsYWc6IGZhbHNlIH0sIHsgbmFtZTogXCI1XCIsIHNob3dGbGFnOiBmYWxzZSB9LCB7IG5hbWU6IFwiNlwiLCBzaG93RmxhZzogZmFsc2UgfSwgeyBuYW1lOiBcIjdcIiwgc2hvd0ZsYWc6IGZhbHNlIH1dLFxyXG4gICAgICBcImhhdmVcIjogW3sgbmFtZTogXCIxXCIsIHNob3dGbGFnOiBmYWxzZSB9LCB7IG5hbWU6IFwiMlwiLCBzaG93RmxhZzogZmFsc2UgfSwgeyBuYW1lOiBcIjNcIiwgc2hvd0ZsYWc6IGZhbHNlIH0sIHsgbmFtZTogXCI0XCIsIHNob3dGbGFnOiBmYWxzZSB9LCB7IG5hbWU6IFwiNVwiLCBzaG93RmxhZzogZmFsc2UgfSwgeyBuYW1lOiBcIjZcIiwgc2hvd0ZsYWc6IGZhbHNlIH0sIHsgbmFtZTogXCI3XCIsIHNob3dGbGFnOiBmYWxzZSB9XVxyXG4gICAgfSxcclxuICAgIHJlbWFyazogXCJcIixcclxuICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgbW9kYWxTaG93OiBmYWxzZVxyXG4gIH0sXHJcblxyXG5cclxuICBvblNoYXJlQXBwTWVzc2FnZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwib25TaGFyZUFwcE1lc3NhZ2VcIik7XHJcbiAgICB2YXIgdmFsdWUgPSB3eC5nZXRTdG9yYWdlU3luYygnY2hhbmdlQ2x1ZScpXHJcbiAgICBpZiAoIXZhbHVlKSB7XHJcbiAgICAgIHZhbHVlID0gXCLlv6vmnaXmib7liLDkvaDpnIDopoHnmoTnur/ntKJ+XCJcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRpdGxlOiAn5piO5pel5pa56Iif5Yqp5omLLee6v+e0ouS6pOaNoicsXHJcbiAgICAgIGRlc2M6IHZhbHVlLFxyXG4gICAgICBpbWFnZVVybDogJy4uLy4uLy4uL2ltYWdlcy9hcms2Ni5qcGcnLFxyXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJzdWNjZXNzXCIpO1xyXG4gICAgICAgIHd4Lm5hdmlnYXRlQmFjayh7ICAgICAvL+i/lOWbnuS4iuS4gOmhtemdouaIluWkmue6p+mhtemdolxyXG4gICAgICAgICAgZGVsdGE6IDFcclxuICAgICAgICB9KX1cclxuICAgIH1cclxuICB9LFxyXG4gIFBpY2tlckNoYW5nZShlOiBhbnkpIHtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgIGxldCB0bXAgPSB0aGlzLmRhdGEuc2VydmVyTGlzdFtlLmRldGFpbC52YWx1ZV07XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgc2VydmVySW5kZXg6IGUuZGV0YWlsLnZhbHVlLFxyXG4gICAgICBzZXJ2ZXI6IHRtcFxyXG4gICAgfSlcclxuICB9LFxyXG5cclxuICBJbnB1dENoYW5nZTogZnVuY3Rpb24gKGU6IGFueSkge1xyXG4gICAgY29uc29sZS5sb2coZS50YXJnZXQuZGF0YXNldC50eXBlKTtcclxuICAgIGNvbnNvbGUubG9nKGUuZGV0YWlsLnZhbHVlKVxyXG4gICAgbGV0IHR5cGUgPSBlLnRhcmdldC5kYXRhc2V0LnR5cGU7XHJcbiAgICBpZiAodHlwZSA9PT0gJ3JlbWFyaycpIHtcclxuICAgICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgICAgcmVtYXJrOiBlLmRldGFpbC52YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnaWQnKSB7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICAgIGlkOiBlLmRldGFpbC52YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICB9LFxyXG5cclxuICBoaWRlTW9kYWw6IGZ1bmN0aW9uICgpIHtcclxuICAgIHd4Lm5hdmlnYXRlQmFjayh7ICAgICAvL+i/lOWbnuS4iuS4gOmhtemdouaIluWkmue6p+mhtemdolxyXG4gICAgICBkZWx0YTogMVxyXG4gICAgfSlcclxuICB9LFxyXG5cclxuXHJcbiAgY2xpY2tDbHVlKGU6IGFueSkge1xyXG4gICAgY29uc29sZS5sb2coZSk7XHJcbiAgICBsZXQgdHlwZSA9IGUudGFyZ2V0LmRhdGFzZXQudHlwZTtcclxuICAgIGxldCBjbHVlID0gZS50YXJnZXQuZGF0YXNldC50aXRsZTtcclxuICAgIC8vQHRzLWlnbm9yZVxyXG4gICAgbGV0IGNsdWVUbXAgPSB0aGlzLmRhdGEuY2x1ZUxpc3RbdHlwZV1bY2x1ZV07XHJcbiAgICBjbHVlVG1wLnNob3dGbGFnID0gIWNsdWVUbXAuc2hvd0ZsYWc7XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgY2x1ZUxpc3Q6IHRoaXMuZGF0YS5jbHVlTGlzdFxyXG4gICAgfSk7XHJcbiAgfSxcclxuICBzYXZlQ2hhbmdlKCkge1xyXG4gICAgLy/liKTmlq3nqbpcclxuICAgIGlmICghdGhpcy5kYXRhLmlkKSB7XHJcbiAgICAgIHd4LnNob3dUb2FzdCh7XHJcbiAgICAgICAgdGl0bGU6IFwi6K+36L6T5YWl5ri45oiPaWRcIixcclxuICAgICAgICBpY29uOiBcIm5vbmVcIixcclxuICAgICAgICBkdXJhdGlvbjogMjAwMFxyXG4gICAgICB9KVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuZGF0YS5zZXJ2ZXIpIHtcclxuICAgICAgd3guc2hvd1RvYXN0KHtcclxuICAgICAgICB0aXRsZTogXCLor7fpgInmi6nmuLjmiI/ljLrmnI1cIixcclxuICAgICAgICBpY29uOiBcIm5vbmVcIixcclxuICAgICAgICBkdXJhdGlvbjogMjAwMFxyXG4gICAgICB9KVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGxldCBuZWVkRmxhZyA9IGZhbHNlO1xyXG4gICAgbGV0IG5lZWRTdHIgPSBcIlwiO1xyXG4gICAgdGhpcy5kYXRhLmNsdWVMaXN0WyduZWVkJ10uZm9yRWFjaCgoY2x1ZTogYW55KSA9PiB7XHJcbiAgICAgIGlmIChjbHVlLnNob3dGbGFnKSB7XHJcbiAgICAgICAgbmVlZEZsYWcgPSB0cnVlO1xyXG4gICAgICAgIG5lZWRTdHIgKz0gY2x1ZS5uYW1lICsgXCIgXCJcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgaGF2ZUZsYWcgPSBmYWxzZTtcclxuICAgIGxldCBoYXZlU3RyID0gXCJcIjtcclxuICAgIHRoaXMuZGF0YS5jbHVlTGlzdFsnaGF2ZSddLmZvckVhY2goKGNsdWU6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoY2x1ZS5zaG93RmxhZykge1xyXG4gICAgICAgIGhhdmVGbGFnID0gdHJ1ZTtcclxuICAgICAgICBoYXZlU3RyICs9IGNsdWUubmFtZSArIFwiIFwiXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgaWYgKCFuZWVkRmxhZykge1xyXG4gICAgICB3eC5zaG93VG9hc3Qoe1xyXG4gICAgICAgIHRpdGxlOiBcIuivt+mAieaLqeiHs+WwkeS4gOS4qumcgOimgeeahOe6v+e0olwiLFxyXG4gICAgICAgIGljb246IFwibm9uZVwiLFxyXG4gICAgICAgIGR1cmF0aW9uOiAyMDAwXHJcbiAgICAgIH0pXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICghaGF2ZUZsYWcpIHtcclxuICAgICAgd3guc2hvd1RvYXN0KHtcclxuICAgICAgICB0aXRsZTogXCLor7fpgInmi6noh7PlsJHkuIDkuKrnlKjmnaXkuqTmjaLnmoTnur/ntKJcIixcclxuICAgICAgICBpY29uOiBcIm5vbmVcIixcclxuICAgICAgICBkdXJhdGlvbjogMjAwMFxyXG4gICAgICB9KVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgcmVxID0geyBpZDogdGhpcy5kYXRhLmlkLCBzZXJ2ZXI6IHRoaXMuZGF0YS5zZXJ2ZXIsIHJlbWFyazogdGhpcy5kYXRhLnJlbWFyaywgY2x1ZUxpc3Q6IHRoaXMuZGF0YS5jbHVlTGlzdCB9XHJcbiAgICBsZXQgdGhhdCA9IHRoaXM7XHJcbiAgICBsZXQgY2hhbmdlQ2x1ZVN0ciA9IHRoaXMuZGF0YS5pZCArIFwiIFwiICsgdGhpcy5kYXRhLnNlcnZlciArIFwiIFwiICsgaGF2ZVN0ciArIFwiIOaNoiBcIiArIG5lZWRTdHI7XHJcbiAgICB0aGF0LnNldERhdGEhKHtcclxuICAgICAgbG9hZGluZzogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBhcHAuZnVuYy5wb3N0KCcvcG9zdENoYW5nZScsIHJlcSwgZnVuY3Rpb24gKHJlc3BvbnNlOiBBcmtSZXNwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcclxuXHJcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgIHd4LnNldFN0b3JhZ2Uoe1xyXG4gICAgICAgICAga2V5OiBcImNoYW5nZUNsdWVcIixcclxuICAgICAgICAgIGRhdGE6IGNoYW5nZUNsdWVTdHJcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB0aGF0LnNldERhdGEhKHtcclxuICAgICAgICAgIGxvYWRpbmc6IGZhbHNlLCBtb2RhbFNob3c6IHRydWVcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxufSkiXX0=